# extends 'layout.html'
<!DOCTYPE html>
<html>
  <head>
    <title>CrashId#${object.id} - ${object.uuid}</title>
    # block head
    ${ super() }
    <script type="text/javascript">
    function extra_click(node, expanded) {
        if (expanded == true) {
            var url = window.location.href;
            var path = window.location.pathname;
            var target_url = (path + '/view/').replace('//', '/') + node.id.replace('___', '/');
            $( '#' + node.id).children('div#placeholder').html('<div class="loading_message">Loading...</div>');
            //$( '#' + node.id).children('div#placeholder').html('here ' + node.id + ' exp=' + expanded + ' url=' + url + ' path=' + path);
            $( '#' + node.id).children('div#placeholder').load(target_url);
            //alert('here ' + node.id + ' exp=' + expanded + ' url=' + url);
        } else {
            $( '#' + node.id).children('div#placeholder').text('');
        }
    }
      jQuery(document).ready(function($) {
        $("div.description").find("h1,h2,h3,h4,h5,h6").addAnchor(_("Link to this section"));
        $(".foldable").delayLoadFolding(false, true, extra_click);
      });
    </script>
    # endblock head
  </head>
  <body>
    # block content
        <div id="crashdump">
            <div class="date">
                <p>{% trans crashtime=pretty_dateinfo(object['crashtime']) %}Crashed ${crashtime}{% endtrans %}</p>
                {% if object['reporttime'] %}<p>{% trans reporttime=pretty_dateinfo(object['reporttime']) %}Report generated ${reporttime}{% endtrans %}</p>{% endif %}
                {% if object['uploadtime'] %}<p>{% trans uploadtime=pretty_dateinfo(object['uploadtime']) %}Uploaded ${uploadtime}{% endtrans %}</p>{% endif %}
                {% if object['closetime'] %}<p>{% trans closetime=pretty_dateinfo(object['closetime']) %}Closed ${closetime}{% endtrans %}</p>{% endif %}
                {% if object['changetime'] != object['uploadtime'] and object['changetime'] != object['closetime']%}
                    <p>{% trans changetime=pretty_dateinfo(object['changetime']) %}Last modified ${changetime}{% endtrans %}</p>
                {% endif %}
            </div>

            <h2>
                <a href="${href('crash', object.uuid)}" class="trac-id">CrashId#${object.id} - {${object.uuid}}</a>
                <span class="trac-status">
                ${'status' in fields_map and fields[fields_map['status']].rendered or object['status']}
                </span>
                {% if object['type'] %}
                <span class="trac-type">${'type' in fields_map and fields[fields_map['type']].rendered or object['type']}</span>
                {% endif %}
                {% if object['resolution'] %}
                <span class="trac-resolution">
                (${'resolution' in fields_map and fields[fields_map['resolution']].rendered or object['resolution']})
                </span>
                {% endif %}
            </h2>
<table class="properties">
<tr>
{% if xmlfile_error %}
<tr>
<th>Error:</th><td colspan="3">${xmlfile_error}</td>
</tr>
{% endif %}
<th>Reported by:</th><td>${object['reporter']}</td>
<th>Owned by:</th><td>${object['owner']}</td>
</tr>
<tr>
<th>Priority:</th><td>${object['priority']}</td>
<th>Severity:</th><td>${object['severity']}</td>
</tr>
<tr>
<th>Version:</th><td>${object['version']}</td>
<th>Milestone:</th><td>${object['milestone']}</td>
</tr>
<tr>
<th>Application name:</th><td>${object['applicationname']}</td>
<th>Component:</th><td>${object['component']}</td>
</tr>
<tr>
<th>Keywords:</th><td>${object['keywords']}</td>
<th>Cc:</th><td>${object['cc']}</td>
</tr>
<tr>
<th>Linked tickets:</th><td><ul>
{% for tkt in linked_tickets %}<li>${tkt}</li>{% endfor %}
</ul>
</td>
</tr>
{% if show_debug_info %}
<tr>
<th>Parse time:</th><td>${ format_seconds(parsetime) }</td>
<th>Database time:</th><td>${ format_seconds(dbtime) }</td>
</tr>
<tr>
<th>Is 64-Bit:</th><td>${is_64_bit}</td>
<th>Bits:</th><td>${bits}</td>
</tr>
{% endif %}
</table>

<!-- close the crashdump yellow box -->
</div>

<div id="crashdump">
<h2 class="foldable" id="crash_dump_info">Crash dump information</h2>
<a name="crash_info"/>
<table class="properties">
<tr><th>Application&nbsp;file</th><td class="fullrow">${object['applicationfile']}</td></tr>
<tr><th>Command&nbsp;line</th><td class="fullrow">
    {% if crash_info %}
    <pre class="cmdline">{% for e in crash_info.command_line %}&quot;${e}&quot;{% endfor %}</pre>
    {% else %}
    <div>N/A</div>
    {% endif %}
</td></tr>
{% if object['minidumpfile'] %}
    <tr><th>Minidump file</th><td class="fullrow">
        <a href="${href('crash', object.uuid, 'minidump_raw')}" title="${object.uuid} (${ format_size(minidumpfile_size) })">Download</a>
        {% if object['minidumpreporttextfile'] %}
            &nbsp;<a href="${href('crash', object.uuid, 'minidump_text')}" title="${object.uuid} (${ format_size(reporttextfile_size) })">Text report</a>
        {% endif %}
        {% if object['minidumpreportxmlfile'] %}
            &nbsp;<a href="${href('crash', object.uuid, 'minidump_xml')}" title="${object.uuid} (${ format_size(xmlfile_size) })">XML report</a>
        {% endif %}
        {% if object['minidumpreporthtmlfile'] %}
            &nbsp;<a href="${href('crash', object.uuid, 'minidump_html')}" title="${object.uuid} (${ format_size(reporthtmlfile_size) })">HTML report</a>
        {% endif %}
    </td></tr>
{% endif %}
{% if object['coredumpfile'] %}
    <tr><th>Coredump file</th><td class="fullrow">
        <a href="${href('crash', object.uuid, 'coredump_raw')}" title="${object.uuid} (${ format_size(coredumpfile_size) })">Download</a>
        {% if object['coredumpreporttextfile'] %}
            &nbsp;<a href="${href('crash', object.uuid, 'coredump_text')}" title="${object.uuid} (${ format_size(reporttextfile_size) })">Text report</a>
        {% endif %}
        {% if object['coredumpreportxmlfile'] %}
            &nbsp;<a href="${href('crash', object.uuid, 'coredump_xml')}" title="${object.uuid} (${ format_size(xmlfile_size) })">XML report</a>
        {% endif %}
        {% if object['coredumpreporthtmlfile'] %}
            &nbsp;<a href="${href('crash', object.uuid, 'coredump_html')}" title="${object.uuid} (${ format_size(reporthtmlfile_size) })">HTML report</a>
        {% endif %}
    </td></tr>
{% endif %}
{% if fast_protect_system_info %}
<tr><th>Crash&nbsp;FQDN</th><td class="fullrow">${fast_protect_system_info.fqdn}&nbsp;<a href="${href('crash', object.uuid, 'sysinfo_report')}" title="${object.uuid} system info">Show complete system info</a>
</td></tr>
<tr><th>Crash&nbsp;username</th><td class="fullrow">${fast_protect_system_info.username}</td></tr>
{% endif %}
{% if crash_info %}
<tr><th>Report&nbsp;FQDN</th><td class="fullrow">${crash_info.report_fqdn}</td></tr>
<tr><th>Report&nbsp;username</th><td class="fullrow">${crash_info.report_username}</td></tr>
<tr><th>Symbol&nbsp;directories</th><td class="fullrow"><ul class="dirlist">{% for e in crash_info.symbol_directories %}<li>${e}</li>{% endfor %}</ul></td></tr>
<tr><th>Image&nbsp;directories</th><td class="fullrow"><ul class="dirlist">{% for e in crash_info.image_directories %}<li>${e}</li>{% endfor %}</ul></td></tr>
<tr><th>Path</th><td class="fullrow">
<ol class="path">
{% for p in crash_info.path %}
    <li>${p}</li>
{% endfor %}
</ol>
</td></tr>
<tr><th>Environment</th><td class="fullrow">
<ul class="environment">
{% for k in sorted(crash_info.environment.keys()) %}
    {% if k.lower() != 'path' %}
        <li>${k}&nbsp;=&nbsp;${crash_info.environment[k]}</li>
    {% endif %}
{% endfor %}
</ul>
</td></tr>
{% endif %}
</table>
</div>

{% if system_info %}
<div id="sysinfo">
<h2 class="foldable" id='late_sysinfo'>System information</h2>
<a name="system_info"/>
</div>
{% endif %}

{% if system_info %}
<div id="sysinfo_ex" class="collapsed">
<h2 class="foldable">More system information</h2>
<a name="more_system_info"/>
</div>
{% endif %}

{% if fast_protect_version_info %}
<div id="fast_protect_version_info">
<h2 class="foldable">Version info</h2>
<a name="fast_protect_version_info"/>
</div>
{% endif %}

{% if exception %}
<div id="exception">
<h2 class="foldable">{% if assertion %}Assertion{% else %}Exception{% endif %}</h2>
<a name="exception"/>
</div>
{% endif %}

{% if modules %}
<div id="modules" class="collapsed">
<h2 class="foldable">Modules</h2>
<a name="modules"/>
</div>
{% endif %}

{% if threads %}
<div id="threads" class="collapsed">
<a name="threads"/>
<h2 class="foldable">Threads</h2>
</div>
{% endif %}

{% if stackdumps %}
<div id="stackdumps">
<h2 class="foldable">Stack dumps</h2>
{% for stackdump in stackdumps %}
{% if not stackdump.simplified %}
<a name="stackdump_${stackdump.threadid}"/>
<div id="stackdump___${stackdump.threadid}" class="${ '' if stackdump.exception else 'collapsed' }">
<h3 class="foldable">
{% if stackdump.thread.main_thread %}Main thread{% endif %}
{% if not stackdump.thread.main_thread and stackdump.thread.rpc_thread %}RPC Thread{% endif %}
{% if not stackdump.thread.main_thread and not stackdump.thread.rpc_thread %}Thread{% endif %}
{% if stackdump.thread.name %}({stackdump.thread.name}){% endif %}
&nbsp;${ hex_format(stackdump.threadid) }{% if stackdump.exception %} with exception{% endif %}
</h3>
</div>
{% endif %}
{% endfor %}
</div>
{% endif %}

{% if memory_regions %}
<div id="memory_regions" class="collapsed">
<h2 class="foldable">Memory regions</h2>
</div>
{% endif %}

{% if memory_blocks %}
<div id="memory_blocks" class="collapsed">
<h2 class="foldable">Memory blocks</h2>
{% for memory_block in memory_blocks %}
<a name="memory_block_${memory_block.base}" style="display: none">memory_block_${memory_block.base}</a>
    <div id="memory_block___${memory_block.base}" class="collapsed">
    <h3 class="foldable" id="memory_block_${memory_block.base}_title">
        Memory block #${memory_block.num} at ${ addr_format(memory_block.base) } size ${ format_size(memory_block.size) }
        {% if memory_block.threadid %}
            (memory of thread ${ hex_format(memory_block.threadid) })
        {% endif %}
    </h3>
    </div>
{% endfor %}
</div>
{% endif %}

    <div class="trac-nav">
        <a href="#content" id="trac-up-view" title="Go to the top">Top</a> &uarr;
    </div>

    # endblock content

  </body>
</html>
